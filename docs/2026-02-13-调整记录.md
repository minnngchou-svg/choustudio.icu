# 2026-02-13 调整记录

## 1. 后台强调色切换后，鼠标跟随颜色不同步
- 问题现象：后台设置里切换强调色后，鼠标跟随粒子仍沿用旧颜色。
- 根因：`CustomCursor` 组件仅在首次挂载时读取一次 `--color-pride-*` 变量，后续主题配置更新未触发颜色刷新。
- 处理方式：
  - 在 `CustomCursor` 中接入 `useThemeColor()`。
  - 监听 `themeConfig` 变化，在变化时重新读取主题色变量并重置颜色轮换索引。
- 变更文件：
  - `/Users/fan/code/fanstudio/src/components/ui/CustomCursor.tsx`

## 2. 代码校验
- 执行命令：`npm run lint -- src/components/ui/CustomCursor.tsx`
- 结果：通过（无 lint 报错）。

## 3. 影响范围
- 仅影响鼠标跟随装饰效果的取色逻辑。
- 不改动后台主题配置存储与主题变量注入流程。

## 4. 后台暗黑模式下“基底灰度”示例区分度优化
- 背景：在暗黑模式中，基底灰度预设里的深色示例不易区分。
- 处理方案（方案1）：
  - 将原“双色圆点”改为“双色小卡片”预览，增大可视面积。
  - 深色示例卡增加固定亮边框：`border-white/20`。
  - 深色示例卡增加轻微内高光：`shadow-[inset_0_1px_0_rgba(255,255,255,0.08)]`。
  - 浅色示例同步增加轻微内高光，保证整体视觉一致性。
- 变更文件：
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/settings/page.tsx`
- 校验：
  - 执行 `npm run lint -- src/app/admin/(dashboard)/settings/page.tsx` 通过（无 error）。
  - 存在与本次改动无关的既有 warning（`@next/next/no-img-element`）：第 488 行、第 911 行。

## 5. 封面比例策略调整：从“单条内容”改为“模块固定比例”
- 调整目标：
  - 不在文章/作品/教程编辑页提供单条封面比例入口。
  - 在“网站设置”中按模块统一配置封面比例（设计作品、开发作品、文章/笔记、视频教程）。
- 实施内容：
  - 设置页新增 4 个模块级封面比例选择，存储到 `pageCopy`。
  - 首页与列表页改为读取模块固定比例渲染封面（模块内统一比例）。
  - 移除作品/文章/教程编辑页的单条封面比例选择控件。
- 变更文件：
  - `/Users/fan/code/fanstudio/src/lib/page-copy.ts`
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/settings/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/(frontend)/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/(frontend)/works/WorksListByType.tsx`
  - `/Users/fan/code/fanstudio/src/app/(frontend)/blog/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/(frontend)/tutorials/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/works/[id]/edit/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/posts/[id]/edit/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/tutorials/[id]/edit/page.tsx`

## 6. 封面上传区联动修复（预览比例与提示文案）
- 问题：
  - 前台比例已生效，但后台封面上传区仍显示固定比例/固定文案。
- 处理：
  - 封面上传预览比例改为读取对应模块的固定比例。
  - 推荐文案改为统一“建议尺寸 + 最小尺寸”格式（覆盖 3:4 / 4:3 / 16:9 / 1:1 / 19:6）。
  - 提示文案（建议尺寸、格式、大小）下移到上传区域底部。
  - 上传区域宽度改为 `w-full`，随外层容器自适应；通过 `aspectRatio` 保持比例固定。
- 变更文件：
  - `/Users/fan/code/fanstudio/src/lib/cover-ratio.ts`
  - `/Users/fan/code/fanstudio/src/components/admin/CoverImageUpload.tsx`
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/works/[id]/edit/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/posts/[id]/edit/page.tsx`
  - `/Users/fan/code/fanstudio/src/app/admin/(dashboard)/tutorials/[id]/edit/page.tsx`
- 校验：
  - 相关改动执行 eslint 通过（无 error，存在项目既有 `img` warning）。
